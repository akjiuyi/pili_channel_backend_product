(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6487f06e"],{"1f38":function(e,t,r){},"4cf1":function(e,t,r){"use strict";r("1f38")},ecac:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[e.user?r("div",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6,xs:24}},[r("user-card",{attrs:{user:e.user}})],1),r("el-col",{attrs:{span:18,xs:24}},[r("el-card",[r("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[r("el-tab-pane",{attrs:{label:"账号",name:"account"}},[r("account")],1)],1)],1)],1)],1)],1):e._e()])},s=[],n=r("5530"),i=(r("b0c0"),r("2f62")),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticStyle:{"margin-bottom":"20px"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("关于我的")])]),r("div",{staticClass:"user-profile"},[r("div",{staticClass:"box-center"}),r("div",{staticClass:"box-center"},[r("div",{staticClass:"user-name text-center"},[e._v(e._s(e.user.name))])])]),r("div",{staticClass:"user-bio"},[r("div",{staticClass:"user-education user-bio-section"},[r("div",{staticClass:"user-bio-section-header"},[r("svg-icon",{attrs:{"icon-class":"education"}}),r("span",[e._v("描述")])],1),r("div",{staticClass:"user-bio-section-body"},[r("div",{staticClass:"text-muted"},[e._v(" token: "+e._s(e.token)+" ")])])])])])},c=[],u={props:{user:{type:Object,default:function(){return{name:"",email:"",avatar:""}}}},data:function(){var e=this.$store.getters.token;return{token:e}},created:function(){}},l=u,d=(r("4cf1"),r("2877")),p=Object(d["a"])(l,o,c,!1,null,"2695bf60",null),f=p.exports,m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"block"},[r("el-timeline",e._l(e.timeline,(function(t,a){return r("el-timeline-item",{key:a,attrs:{timestamp:t.loginDate,placement:"top"}},[r("el-card",[r("h4",[e._v(e._s(t.loginIp))]),r("p",[e._v(e._s(t.userAgent))])])],1)})),1)],1)},w=[],h=r("1da1"),v=(r("96cf"),r("c24f")),b={data:function(){return{timeline:[]}},created:function(){this.getNearLoginList()},methods:{getNearLoginList:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(v["nearLoginList"])();case 2:t=e.sent,this.timeline=t;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},g=b,x=Object(d["a"])(g,m,w,!1,null,null,null),k=x.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"userDataForm",attrs:{model:e.userData,rules:e.rules}},[r("el-row",{staticStyle:{"margin-bottom":"20px"}},[r("span",{staticStyle:{"font-size":"small","font-family":"'PingFang SC'"}},[e._v("最后登录时间："+e._s(e.userData.lastLoginDate))])]),r("el-divider"),r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{disabled:""},model:{value:e.userData.username,callback:function(t){e.$set(e.userData,"username",t)},expression:"userData.username"}})],1),r("el-form-item",{attrs:{label:"修改密码",prop:"editPassword"}},[r("el-switch",{model:{value:e.editPassword,callback:function(t){e.editPassword=t},expression:"editPassword"}})],1),e.editPassword?r("div",[r("el-divider"),r("el-form-item",{staticStyle:{width:"280px"},attrs:{label:"原始密码",prop:"password"}},[r("el-input",{attrs:{placeholder:"",autocomplete:"off",type:"password"},model:{value:e.userData.password,callback:function(t){e.$set(e.userData,"password","string"===typeof t?t.trim():t)},expression:"userData.password"}})],1),r("el-form-item",{staticStyle:{width:"280px"},attrs:{label:"新密码",prop:"newPassword"}},[r("el-input",{attrs:{placeholder:"请输入3-20位字符,字符必须是英文、字母、下划线",autocomplete:"off",type:"password",minlength:"6,",maxlength:"20","show-password":!1},model:{value:e.userData.newPassword,callback:function(t){e.$set(e.userData,"newPassword","string"===typeof t?t.trim():t)},expression:"userData.newPassword"}})],1),r("el-form-item",{staticStyle:{width:"280px"},attrs:{label:"确认新密码",prop:"checkNewPass"}},[r("el-input",{attrs:{placeholder:"请确认密码",autocomplete:"off",type:"password","show-password":!1},model:{value:e.userData.checkNewPass,callback:function(t){e.$set(e.userData,"checkNewPass","string"===typeof t?t.trim():t)},expression:"userData.checkNewPass"}})],1),r("el-divider")],1):e._e(),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmEditSelf("userDataForm")}}},[e._v("更新")])],1)],1)},D=[],_={data:function(){var e=this,t=function(t,r,a){if(""===r||void 0===r)a(new Error("请输入新密码"));else{var s=/^[a-zA-Z0-9_]{3,20}$/;s.test(r)||a(new Error("密码格式不正确")),""!==e.userData.checkNewPass&&e.$refs.userDataForm.validateField("checkNewPass"),a()}},r=function(t,r,a){""===r||void 0===r?a(new Error("请再次输入密码")):r!==e.userData.newPassword?a(new Error("两次输入密码不一致!")):a()};return{userData:{username:"",createdAt:"",password:"",newPassword:"",checkNewPass:""},editPassword:!1,rules:{username:[{required:!0,message:"请输入用户名称",trigger:"blur"}],password:[{required:!0,message:"请输入原来的密码",trigger:"blur"}],newPassword:[{validator:t,trigger:"blur"}],checkNewPass:[{validator:r,trigger:"blur"}]}}},created:function(){this.getInfo()},methods:{getInfo:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(v["b"])();case 2:t=e.sent,this.userData=t;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),confirmEditSelf:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs[e].validate((function(e){if(!e)return!1;t.resetPwd()}));case 1:case"end":return r.stop()}}),r)})))()},resetPwd:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(v["e"])(this.userData);case 2:if(t=e.sent,this.editPassword=!1,this.$message({type:"success",message:"更新成功"}),this.userData.newPassword=this.userData.password="",!0!==t.resetToken){e.next=10;break}return e.next=9,this.$store.dispatch("user/logout");case 9:this.$router.push("/login?redirect=".concat(this.$route.fullPath));case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},y=_,$=Object(d["a"])(y,P,D,!1,null,null,null),j=$.exports,C={name:"Profile",components:{UserCard:f,Timeline:k,Account:j},data:function(){return{user:{},activeTab:"account"}},computed:Object(n["a"])({},Object(i["b"])(["name","avatar","roles"])),created:function(){this.getUser()},methods:{getUser:function(){this.user={name:this.name,avatar:this.avatar}}}},O=C,E=Object(d["a"])(O,a,s,!1,null,null,null);t["default"]=E.exports}}]);